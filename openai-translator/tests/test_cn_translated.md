中国远洋海运集团は、データ統合および共有-API プラットフォームです。
使用方法
中远海运科技股份有限公司

---

アクセスアドレス
システムのアクセスアドレスは、https://api.coscoshipping.com/です。
システムのホームページは以下の画像の通りです：
1

---

ユーザーログイン
ページの右上にある「ログイン」ボタンをクリックして、ログイン画面に進みます：
ユーザー名とパスワードを入力した後、「ログイン」ボタンをクリックすると、ログインが完了します。
⚫ パスワードを忘れた場合
パスワードを忘れた場合、ログインページの下部にある「パスワードを忘れた方はこちら」のリンクをクリックし、表示されるページでアカウントのメールアドレスを入力すると、パスワードリセット用のメールが受信され、パスワードをリセットすることができます。

---

初めてシステムにアクセスする際には、以下の確認および認証ページが表示されます。 「ユーザー名」にチェックを入れ、「同意する」ボタンをクリックしてシステムへのアクセス認可を完了してください。

---

三、APIの閲覧と検索
ホームページの各カテゴリーアイコンをクリックすると、該当する分類のAPIを閲覧できます。また、ページの右側にある「タグ」からも該当する機能のAPIに迅速にアクセスすることができます。
システムは複数の方法でAPIを検索することができます。ページ上部の「検索」ボックスの右側にマウスを移動すると、検索条件のヒントが表示されます（右の図を参照）。
例えば、航標APIを提供しているssmpを検索する場合、
検索ボックスに入力するのは:
provider:ssmp
間にスペースは入れずに、Enterキーを押すと、ssmpが作成したすべてのAPIが表示されます。
APIアイコンをクリックすると、API情報閲覧画面に移動できます。
基本情報
ページには現在のAPIのバージョン、作者、更新日時、現在の状態、評価などの基本情報が表示されます。同時に、APIの呼び出しアドレス、説明、文書、SDKなどもページの下部に表示されます。

---

開発サポート
概要やドキュメントを閲覧することで、APIの使用方法を理解することができます。また、APIコンソールでは、このAPIが提供するメソッド、フォーマットの定義、異なるレスポンスコードなどの情報を詳細に閲覧することができ、ページ上で直接このAPIを試すこともできます。
APIコンソール
APIマーケットでは、Swaggerの統合により、Open API Specificationへのサポートが提供されます。APIコンソールでは、APIの詳細定義、エンドポイントの定義、データフォーマットの要件などの情報を閲覧することができ、swaggerツールを使用してオンラインでAPIをテストすることもできます。
右上の「試してみる」をクリックすることで、直接オンラインでAPIを呼び出すことができます。

---

、APIの使用
1、APIの購読
APIを使用する前に、まずAPIに購読する必要があります。購読方法は次のとおりです。
A. APIの詳細情報ページにアクセスする。
B. 画面の右上部に購読ボタンがあり、上部で対応する「アプリ」と「レベル」を選択できます。このAPIにまだ購読していない場合、「アプリ」にはデフォルトの値である「DefaultApplication」が表示されます。それ以外の場合は、「アプリを選択...」と表示されます。
C. 「レベル」は購読する同時接続レベルを示し、それぞれ「無制限」、 「Gold」（1分間に5000リクエスト）、 「Silver」（1分間に2000リクエスト）、 「Bronze」（1分間に1000リクエスト）があります。デフォルトは「無制限」レベルであり、デフォルトのままで構いません。
D. アプリとレベルを選択したら、「購読」ボタンをクリックして購読を完了します。
2、APIのアクセスアドレス
APIのアクセスアドレスは2つの部分で構成されており、関連情報はそれぞれ「概要」ページと「APIコンソール」ページにあります。
「概要」ページでは、「本番環境とテスト環境のアクセスアドレス」が表示されます。
「APIコンソール」では、各個別のエンドポイントが表示されます。

---

それでは、「バルト海乾貨運賃指数」のAPIエンドポイントの呼び出しアドレスは次のとおりです：https://apigw.coscoshipping.com/env/freightIndex/v2/balticDryIndex
プラットフォームはトークンを使用して本番環境とテスト環境を区別し、すべての環境の呼び出しには同じ呼び出しアドレスが使用されます。
3.認証
認証はAPI管理プラットフォームの認証とAPIインターフェイスのバックエンド認証の2つで構成されます。APIインターフェースのバックエンド認証については、関連するAPIのドキュメントを参照してください。API管理プラットフォームではOAuth2を使用して認証を行い、APIを呼び出す前にトークンを取得する必要があります。
左側のメニューから「アプリケーション」をクリックし、アプリケーション管理に入ります。右側のリストから「DefaultApplication」をクリックし、アプリケーションの詳細情報に入ります。
A. 詳細情報：このアプリケーションの基本情報を表示します
B. 本番環境キー：この画面には本番環境に関連する設定が表示されます。
C. テスト環境キー：この画面にはテスト環境に関連する設定が表示されます。
D. サブスクリプション：このアプリケーションが購読しているAPIを表示します。
初めて「本番環境キー」ページにアクセスすると、「この種類のアプリケーションには現在生成されたキーはありません」というメッセージが表示されます。下の図を参照してください。

---

この時、ページの下部にある「鍵を生成する」ボタンをクリックして鍵を生成することができます。この操作によって、アプリのConsumer ID（消費者ID）とKey（鍵）も初期化されます。生成が成功したら、以下の画面が表示されます。
「鍵を表示する」ボタンをクリックすると、Consumer IDとConsumer Keyの具体的な内容が表示されます。8

---

アクセストークンを取得する際は、API管理プラットフォームに対してHTTP POSTリクエストを送信することができます。リクエスト内容は以下の通りです：
- リクエストURL: https://apigw.coscoshipping.com/token
- リクエスト内容: grant_type=client_credentials
- リクエストContent-type: application/x-www-form-urlencoded
- 認証情報: Basic Auth、ユーザ名はConsumer ID、パスワードはConsumer Key

アクセストークンの取得方法も、下図のように表示されています。アクセストークンを取得するためには、Client Credentialsの方式を使用することをお勧めします。

リクエストのレスポンスとして返されるJSONオブジェクトの"access_token"フィールドが生成されたアクセストークンです。アクセストークンのデフォルトの有効期間は1時間であり、有効期間が切れた場合には再取得が必要です。有効期間内であれば、繰り返し取得しても同じアクセストークンが返されます。アプリケーションでは、トークンをローカルにキャッシュすることをお勧めします。

APIページでAPIを呼び出す場合は、まず使用するアプリケーションと環境を選択してください。プラットフォームは自動で対応するトークンを入力してくれます。

トークンの有効期限が切れているか、現在使用可能なトークンがない場合は、ページの左側メニューの「アプリ」メニューをクリックして、アプリ管理画面に戻り、トークンを再生成してください。

APIを呼び出す際には、本番環境とテスト環境の関連するアカウント情報とトークンを明確に区別することに特に注意してください。混乱によりデータが誤った環境に送信されることを避けてください。

---

4、API呼び出し
APIを呼び出す際には、APIのインターフェース定義に従ってパラメータを渡す必要があります。さらに、認証ヘッダー情報を追加する必要があります。内容は以下の通りです：
• キー: Authorization
• 値: Bearer <access_token>
つまり、ヘッダーの内容は、固定の文字列"Bearer"とステップ3で取得したアクセストークンを結合したものです。"Bearer"とアクセストークンの間にはスペースがあります。
なお、一部のAPIはエンドポイントごとに認可されており、APIを呼び出す際に「You are not allowed to perform this action.」というメッセージが返され、HTTPコードが401である場合、そのエンドポイントには認可が必要ないことを示しています。

---

5、よくある間違った形式
以下はAPIプラットフォームからのエラーで、バックエンドのインターフェースのエラーについては各APIインターフェースの定義を参照してください。
1、トークンインターフェース
• 返り値の形式：
{
"error_description": "……",
"error": "invalid_request"
}
"error_description"がエラーメッセージを返し、"error"が具体的なエラーを返します。
• Http Code: 400/401
2、APIインターフェース
• XMLの返り値の形式：
<ams:fault xmlns:ams="http://wso2.org/apimanager/security">
<ams:code>900901</ams:code>
<ams:message>Invalid Credentials</ams:message>
<ams:description>Access failure for API status: (900901) - Invalid Credentials. Make
sure you have given the correct access token</ams:description>
</ams:fault>
• JSONの返り値の形式：
{
"fault": {
"code": 900901,
"message": "Invalid Credentials",
"description": "Access failure for API: status: (900901) - Invalid Credentials. Make
sure you have given the correct access token"
}
}
• Http Code: 400/401
返り値の中で、Codeはエラーコードを、Messageはエラー名を、Descriptionはエラーの説明文を表します。一般的なエラーコードの意味についてはドキュメントの付録「APIプラットフォームエラーコード」を参照してください。

---

、トークンのリクエスト
「Authorization」のページで、「Basic Auth」を選択し、API プラットフォームから取得した「Consumer ID」と「Consumer Password」をユーザー名とパスワードに入力します。
「Body」タブで、「タイプ」を「x-www-form-urlencoded」に選択し、スクリーンショットのように内容を入力します。
特別な設定は「Header」タブでは必要ありません。Postmanが自動的に生成します。
設定が完了したら、「Send」ボタンをクリックしてトークンのリクエストを完了します。
返されるデータは、JSONオブジェクトであり、その中の「access_token」プロパティがAccessトークンです。

---

2、APIの呼び出し
"Authorization"で"Bearer Token"を選択し、内容には最初のステップで取得したaccess_tokenを入力します。
他の要求データをインタフェースドキュメントの要件に従って入力し、"送信"をクリックします。
13

---

APIプラットフォームのエラーコードについて：
このAPIは一時的にブロックされています。後で再試行するか、システム管理者に連絡してください。

メッセージの送信/受信が資源レベルを超えたため、メッセージはサーバーサイドで制限されました。

APIの使用に関する指定期間内のリクエスト上限に達し、APIの使用が制限されました。

APIの使用がAPI自体の制限を超えたため、APIの使用量が制限されました。

資源レベルが超過したため、メッセージの送信/受信が制限されました。

アプリケーションレベルが超過したため、メッセージの送信/受信が制限されました。

購読レベルの制限により、メッセージの送信/受信が制限されました。

管理者ユーザーがユーザー、IP、アプリケーション、またはAPIコンテキストをブロックしたAPIにアクセスしました。

カスタムのスロットリングポリシールールを超えたため、メッセージの送信/受信が制限されました。

定期購読レベルポリシーでの秒間リクエスト上限（リクエスト/秒）を超えたため、メッセージが制限されました。

未分類のエラーが発生しました。

提供された認証情報が正しくありません。

認証情報が提供されていません。

APIを呼び出す際に正しくないアクセストークンタイプが提供されました。

アクセストークンタイプがサポートされていないため、APIを呼び出せません。

適切な認証情報が提供されていません（Authorization: BearerのHTTPヘッダーが必要です）。

アクセストークンのタイプが間違って提供されました。

| [コード(Code), | エラーメッセージ(Message), | 説明(Description), | 説明] | [700700, | APIがブロックされました, | 一時的にこのAPIはブロックされました。後で再試行するか、システム管理者に連絡してください。, | 使用禁止されたAPIを呼び出しました] | [900800, | メッセージが制限されました, | 特定の時間期間内にAPIへのリクエストの最大数に達し、APIの使用が制限されました。, | APIのサブスクリプションレベル制限を超えたAPI呼び出しです。] | [900801, | ハードリミットを超えました, | ハードなAPI制限に達しました。, | APIの使用がAPI自体の制限を超えました。] | [900802, | リソースレベル制限を超えました, | メッセージがリソースレベルを超えたため、制限されました。, | 認可されたリソースレベルを超えるメッセージの送信/受信です。] | [900803, | アプリケーションレベル制限を超えました, | アプリケーションレベルを超えたため、メッセージは制限されました。, | 認可されたアプリケーションレベルを超えるメッセージの送信/受信です。] | [900804, | サブスクリプションレベル制限を超えました, | サブスクリプションレベルの制限に達したため、メッセージは制限されました。, | サブスクリプションレベルのスロットリング制限により、メッセージが制限されました。] | [900805, | メッセージがブロックされました, | ユーザー、IP、アプリケーション、またはAPIコンテキストでブロックされているAPIにアクセスしています。, | 管理者ユーザーによってユーザー、IP、アプリケーション、またはAPIコンテキスト上でAPI呼び出しがリアルタイムでブロックされます。API呼び出しがブロック条件に一致します。] | [900806, | カスタムポリシーが制限されました, | カスタムスロットルポリシールールを介して構成された制限を超えたため、メッセージは制限されました。, | API呼び出しがカスタムスロットルポリシールールを満たし、カスタムスロットルポリシーの制限を超えました。] | [900807, | メッセージが制限されました, | サブスクリプションレベルのポリシーでバースト制御/レート制限(1秒あたりのリクエスト数)を超えたため、メッセージが制限されました。, | 1秒間にコンフィギュレーションされたバースト制御/レート制限を超えるメッセージの送信/受信です。] | [900900, | 未分類の認証エラー, | 不明なエラーが発生しました。, | API呼び出しで、バックエンドサービスにアクセスできませんでした。] | [900901, | 無効な資格情報, | 無効な認証情報が提供されました。, | アクセストークンを更新した後に古いアクセストークンを使用しています。] | [900902, | 資格情報が不足しています, | 認証情報が提供されていません。, | APIにアクセスする際に、Authorization: | BearerのHTTPヘッダーが欠落しています。] | [900905, | 間違ったアクセストークンタイプが提供されました, | APIを呼び出す際にサポートされていないアクセストークンタイプが使用されています。サポートされているアクセストークンタイプは、アプリケーションユーザートークンのみ許可されているリソースでAPIを呼び出すものです。] |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |


---

リクエスト内のリソース名に一致するリソースが見つかりませんでした
API内でAPIが見つからない要求されたAPI
APIユーザーが一時的にブロックされています。使用中に発生します
APIリソースのサブスクリプションがブロックされています
APIを呼び出すユーザーは、必要なリソースへのアクセスが許可されていません
APIのステータスが変更され、アクセスできなくなりました
アクセスする必要なリソースへのアクセス許可がアクセストークンにないため、APIにアクセスできません
リクエストで送信されたペイロードが大きすぎて、クライアントは接続を保持してAPIに完全に転送することができません
15（エラーコード）

| [, | , | アプリケーションとユーザーへのアクセストークンです。] | [900906, | APIで指定されたリクエストに一致するリソースは見つかりませんでした。, | リクエストで指定された名前のリソースはAPI内で見つかりません。, | 使用できないAPIリソースを呼び出します。] | [900907, | リクエストされたAPIが一時的にブロックされています。, | APIユーザーがブロックされている場合に発生します。, | API提供者によってブロックされているサブスクリプションでAPIリソースを使用します。] | [900908, | リソースが禁止されています。, | APIの呼び出し元ユーザーが必要なリソースへのアクセス権を付与されていません。, | サブスクライブされていないAPIを呼び出します。] | [900909, | APIのサブスクリプションが無効です。, | APIのステータスが利用できない/アクセスできない状態に変更されました。, | 管理者の承認を待っている未承認のサブスクリプションでAPIリソースを使用します。] | [900910, | アクセストークンはリクエストされたリソースへのアクセスを許可しません。, | 提供されたアクセストークンで必要なリソースにアクセスできません。このトークンでアクセスできる有効なリソースを確認してください。, | リソーススコープと一緒に生成されていないアクセストークンを使用してAPIリソースを呼び出します。] | [102511, | ペイロードが不完全です。, | リクエストと共に送信されるペイロードが大きすぎ、クライアントはペイロードが完全にAPIゲートウェイに転送されるまで接続を維持できません。, | データが大きすぎてタイムアウトしてAPIプラットフォームに転送されませんでした。] |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |


